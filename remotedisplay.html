<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<!--<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">-->
<title>PicoPew</title>
<script type="text/javascript">
var ws = null;
var gamma = [19, 33, 42, 48, 53, 57, 61, 65, 68, 71, 74, 77, 79, 82, 84, 86, 89, 91, 93, 94, 96, 98, 100, 102, 103, 105, 106, 108, 109, 111, 112, 114, 115, 117, 118, 119, 120, 122, 123, 124, 125, 127, 128, 129, 130, 131, 132, 133, 134, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 146, 147, 148, 149, 150, 151, 152, 153, 154, 154, 155, 156, 157, 158, 159, 160, 160, 161, 162, 163, 164, 164, 165, 166, 167, 167, 168, 169, 170, 170, 171, 172, 173, 173, 174, 175, 175, 176, 177, 177, 178, 179, 179, 180, 181, 181, 182, 183, 183, 184, 185, 185, 186, 187, 187, 188, 189, 189, 190, 190, 191, 192, 192, 193, 193, 194, 195, 195, 196, 196, 197, 198, 198, 199, 199, 200, 200, 201, 202, 202, 203, 203, 204, 204, 205, 205, 206, 206, 207, 208, 208, 209, 209, 210, 210, 211, 211, 212, 212, 213, 213, 214, 214, 215, 215, 216, 216, 217, 217, 218, 218, 219, 219, 220, 220, 221, 221, 222, 222, 223, 223, 224, 224, 225, 225, 226, 226, 226, 227, 227, 228, 228, 229, 229, 230, 230, 231, 231, 231, 232, 232, 233, 233, 234, 234, 235, 235, 235, 236, 236, 237, 237, 238, 238, 239, 239, 239, 240, 240, 241, 241, 241, 242, 242, 243, 243, 244, 244, 244, 245, 245, 246, 246, 246, 247, 247, 248, 248, 248, 249, 249, 250, 250, 250, 251, 251, 252, 252, 252, 253, 253, 254, 254, 254, 255, 255];

function connect() {
	if (window.location.hash.length <= 1) {
		window.location.hash = '#picopew.local:8400';
	}
	ws = new WebSocket('ws://' + window.location.hash.substring(1));
	ws.binaryType = 'arraybuffer';
	ws.addEventListener('message', e => {
		var a = new Uint8Array(e.data);
		if (a.length == 128) {
			for (var i = 0; i < 64; i++) {
				var g = a[2*i];
				var r = a[2*i + 1];
				r = Math.min(Math.floor(r + 0.1*g + 0.5), 255);
				g = Math.floor(0.35*g + 0.5);
				r = gamma[r];
				g = gamma[g];
				document.getElementById('px' + i).style.fill = 'rgb(' + r + ', ' + g + ', 19)';
			}
		}
		else if (a.length == 1) {
			a = a[0];
			for (var i = 0; i < 6; i++) {
				document.getElementById('bt' + i).style.fill = (a & 1) ? '#999900' : '#444444';
				a >>= 1;
			}
		}
	});
	ws.addEventListener('error', e => { console.log('Websocket error', e); });
	ws.addEventListener('close', e => { console.log('Websocket closed', e); });
}

function disconnect() {
	ws.close();
}

function onWindowResize() {
	var img = document.getElementById('image');
	img.style.width = (window.innerWidth - 16) + 'px';
	img.style.height = (window.innerHeight - 16) + 'px';
}

document.addEventListener('DOMContentLoaded', function() {
	connect();
	window.addEventListener('beforeunload', function () {
		disconnect();
	});
	window.addEventListener('resize', onWindowResize);
	onWindowResize();
});

</script>
<style>
body {
	background-color: #000000;
	margin: 0;
	text-align: center;
}
</style>
</head>
<body>
	<svg width="484" height="200" viewBox="2.4 -20 48.4 20" id="image">
		<g transform="scale(1, -1)">
			<path d="M 46.8 0 A 12.58 12.58 0 0 1 50.8 9.2 L 50.8 18.5 A 34.083331 34.083331 0 0 1 40.8 20 L 12.4 20 A 34.083331 34.083331 0 0 1 2.4 18.5 L 2.4 9.2 A 12.58 12.58 0 0 1 6.4 0 Z" style="fill: #000033;"/>
			<g transform="translate(6.205, 10)">
				<rect x="-2.1" y="-1.6" width="4.2" height="3.2" style="fill: #333333"/>
				<rect x="-1.5" y="-1.1" width="3.0" height="2.2" rx="1.1" ry="1.1" style="fill: #444444" id="bt2"/>
			</g>
			<g transform="translate(14.605, 10)">
				<rect x="-2.1" y="-1.6" width="4.2" height="3.2" style="fill: #333333"/>
				<rect x="-1.5" y="-1.1" width="3.0" height="2.2" rx="1.1" ry="1.1" style="fill: #444444" id="bt3"/>
			</g>
			<g transform="translate(10.405, 14.2) rotate(90)">
				<rect x="-2.1" y="-1.6" width="4.2" height="3.2" style="fill: #333333"/>
				<rect x="-1.5" y="-1.1" width="3.0" height="2.2" rx="1.1" ry="1.1" style="fill: #444444" id="bt4"/>
			</g>
			<g transform="translate(10.405, 5.8) rotate(90)">
				<rect x="-2.1" y="-1.6" width="4.2" height="3.2" style="fill: #333333"/>
				<rect x="-1.5" y="-1.1" width="3.0" height="2.2" rx="1.1" ry="1.1" style="fill: #444444" id="bt1"/>
			</g>
			<g transform="translate(46.99, 13.81) rotate(30)">
				<rect x="-2.1" y="-1.6" width="4.2" height="3.2" style="fill: #333333"/>
				<rect x="-1.5" y="-1.1" width="3.0" height="2.2" rx="1.1" ry="1.1" style="fill: #444444" id="bt5"/>
			</g>
			<g transform="translate(44.45, 6.19) rotate(30)">
				<rect x="-2.1" y="-1.6" width="4.2" height="3.2" style="fill: #333333"/>
				<rect x="-1.5" y="-1.1" width="3.0" height="2.2" rx="1.1" ry="1.1" style="fill: #444444" id="bt0"/>
			</g>
			<g transform="translate(29.21, 10)">
				<rect x="-10" y="-10" width="20" height="20" style="fill: #000000;"/>
				<rect x="-9.9" y="7.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px0"/>
				<rect x="-7.4" y="7.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px1"/>
				<rect x="-4.9" y="7.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px2"/>
				<rect x="-2.4" y="7.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px3"/>
				<rect x="0.1"  y="7.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px4"/>
				<rect x="2.6"  y="7.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px5"/>
				<rect x="5.1"  y="7.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px6"/>
				<rect x="7.6"  y="7.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px7"/>
			
				<rect x="-9.9" y="5.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px8"/>
				<rect x="-7.4" y="5.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px9"/>
				<rect x="-4.9" y="5.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px10"/>
				<rect x="-2.4" y="5.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px11"/>
				<rect x="0.1"  y="5.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px12"/>
				<rect x="2.6"  y="5.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px13"/>
				<rect x="5.1"  y="5.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px14"/>
				<rect x="7.6"  y="5.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px15"/>
			
				<rect x="-9.9" y="2.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px16"/>
				<rect x="-7.4" y="2.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px17"/>
				<rect x="-4.9" y="2.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px18"/>
				<rect x="-2.4" y="2.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px19"/>
				<rect x="0.1"  y="2.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px20"/>
				<rect x="2.6"  y="2.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px21"/>
				<rect x="5.1"  y="2.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px22"/>
				<rect x="7.6"  y="2.6" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px23"/>
			
				<rect x="-9.9" y="0.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px24"/>
				<rect x="-7.4" y="0.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px25"/>
				<rect x="-4.9" y="0.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px26"/>
				<rect x="-2.4" y="0.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px27"/>
				<rect x="0.1"  y="0.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px28"/>
				<rect x="2.6"  y="0.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px29"/>
				<rect x="5.1"  y="0.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px30"/>
				<rect x="7.6"  y="0.1" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px31"/>
			
				<rect x="-9.9" y="-2.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px32"/>
				<rect x="-7.4" y="-2.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px33"/>
				<rect x="-4.9" y="-2.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px34"/>
				<rect x="-2.4" y="-2.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px35"/>
				<rect x="0.1"  y="-2.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px36"/>
				<rect x="2.6"  y="-2.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px37"/>
				<rect x="5.1"  y="-2.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px38"/>
				<rect x="7.6"  y="-2.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px39"/>
			
				<rect x="-9.9" y="-4.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px40"/>
				<rect x="-7.4" y="-4.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px41"/>
				<rect x="-4.9" y="-4.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px42"/>
				<rect x="-2.4" y="-4.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px43"/>
				<rect x="0.1"  y="-4.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px44"/>
				<rect x="2.6"  y="-4.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px45"/>
				<rect x="5.1"  y="-4.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px46"/>
				<rect x="7.6"  y="-4.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px47"/>
			
				<rect x="-9.9" y="-7.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px48"/>
				<rect x="-7.4" y="-7.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px49"/>
				<rect x="-4.9" y="-7.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px50"/>
				<rect x="-2.4" y="-7.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px51"/>
				<rect x="0.1"  y="-7.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px52"/>
				<rect x="2.6"  y="-7.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px53"/>
				<rect x="5.1"  y="-7.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px54"/>
				<rect x="7.6"  y="-7.4" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px55"/>
			
				<rect x="-9.9" y="-9.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px56"/>
				<rect x="-7.4" y="-9.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px57"/>
				<rect x="-4.9" y="-9.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px58"/>
				<rect x="-2.4" y="-9.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px59"/>
				<rect x="0.1"  y="-9.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px60"/>
				<rect x="2.6"  y="-9.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px61"/>
				<rect x="5.1"  y="-9.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px62"/>
				<rect x="7.6"  y="-9.9" width="2.3" height="2.3" rx="0.5" style="fill: #131313;" id="px63"/>
			</g>
		</g>
	</svg>
</body>
</html>
